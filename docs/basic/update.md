# Настройка обновления

Есть 2 способа публекации новых версий лаунчера:
- `github` - Создаётся публичный репозиторий где в вкладке `Releases` будут храница новые версии  
- `s3` - Облачное хранилище файлов. Для опытных людей  

Компиляция новой версии будет выполнятся при каждом изменении файлов в репозитории, а выгрузка релиза будет выполнятся когда в конфиге `package.json` измениться значение `version`.

## Настройка компиляции

Все настройки хранятся в файле `package.json`.  
Он длинный так что расмотрим саммые интересные настройки:
```json
"version": "0.0.4-rc.1",
"build": {
        "appId": "ru.aurora.launcher",
        "productName": "Aurora Launcher",
        "publish": [
            {
                "provider": "s3",
                "bucket": "1d9331f7-f396817b-b981-4ede-980b-acfe89b8ba52",
                "endpoint": "https://s3.timeweb.com"
            },
            {
                "provider": "github",
                "releaseType": "release",
                "repo": "LauncherPublic",
                "owner": "JoCat"
            }
        ],
```

##### Описание настроек конфига
- `version` - номер версии лаунчера  
- `productName` - название вашего лаунчера  
- `publish` - где будет храница новые версии лаунчера  

Для настройки оставте нужный вариант в `package.json`.  
:::details Пример:
- Пример настройки `github`:
```json
"publish": [
            {
                "provider": "github",
                "releaseType": "release",
                "repo": "LauncherPublic",
                "owner": "JoCat"
            }
        ],
```

##### Описание настроек конфига
- `provider` - тип публикации обновлений  
- `releaseType` - какой вид имеет релиз  
- `repo` - название публичного репозитория  
- `owner` - от лица кого будет публикованн релиз  
:::

## Выпускаем токин для репозитория

Для того чтобы у компилятора был доступ к публичному репозиторию нужно создать токен доступа в вашем аккаунте GitHub. Переходим в [Настройки аккаунта](https://github.com/settings/tokens?type=beta) и нажимаем кнопку `Generate new token`.  
В поле `Token name` водим лёбое имя токена. В списке `Expiration` выбераем сколько времени будет действовать токин (Максимальное время 1 год). В `Repository access` выбераем `Only select repositories` и выбераем ваш **Публичный репозиторий**. В `Repository permissions` ищем разрешение `Contents` и даём доступ `Read and write`. После нажатия `Generate token` скопируйте токен он нам понадобится для дольнейшей настройки.
![2.png](/foto-github/2.png)

## Настройка выгрузки релизов

Переходим к репозиторию где у вас храница Launcher и входим в вкладку `Settings`. В столбце слева ищем `Secrets and variables` и переходим в `Actions`. Создаём новый Секрет через кнопку `New repository secret`. Название у Секрета должно быть `GH_TOKEN` а в поле `Secret` токен который мы сгенерировали в [теме сверху](#выпускаем-токин-для-репозитория).
![3.png](/foto-github/3.png)