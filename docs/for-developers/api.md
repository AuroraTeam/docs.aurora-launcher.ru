# API

Описание API лаунчсервера

## Общая информация

API для общения лаунчера/сервер-враппера с лаунчер-сервером реализован посредством клиент-серверного подключения через [WebSocket](https://developer.mozilla.org/ru/docs/Web/API/WebSocket).

## Обмен данными

Обмен данными осуществляется по WebSocket каналу в формате JSON.  
Все неподходящие запросы лаунчер-сервер отбрасывает с кодом ошибки `100` с соответствующим сообщением ошибки парсинга функцией [JSON.parse](https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse).

Примеры типизации request/response на ЯП Typescript:

```ts
interface Request {
  type: string;
  uuid: uuidv4;
  data: object;
}

interface Response {
  uuid: uuidv4;
  data: object;
}
```

При возврате ошибки используется следующий тип:

```ts
interface ResponseError {
  uuid: uuidv4;
  code: number;
  message: string;
}
```

В данных примерах `uuidv4` реализует тип строки являющийся валидным [uuidv4](<https://ru.wikipedia.org/wiki/UUID#Версия_4_(случайный)>) токеном.

В случае, если клиент отдаёт не валидный json объект или объект запроса с отсутствующим uuid, то лаунчсервер возвращает ответ с NIL_UUID (00000000-0000-0000-0000-000000000000).  
Далее в примерах для значения UUID будет указываться NIL_UUID, но на самом деле вы должны отправлять запросы с `uuidv4`.

### Аутентификация

Для работы с API требуется пройти аутентификацию. Для этого нужно отправить запрос типа `auth` со следующим содержимым:

```json
{
  "type": "auth",
  "uuid": "00000000-0000-0000-0000-000000000000",
  "data": {
    "login": "login123",
    "password": "password456"
  }
}
```

Ответ возвращается в следующем формате:

```json
{
  "uuid": "00000000-0000-0000-0000-000000000000",
  "data": {
    "login": "login123",
    "userUUID": "00000000-0000-0000-0000-000000000000",
    "accessToken": "00000000-0000-0000-0000-000000000000"
  }
}
```

При использовании RejectProvider вы получаете стандартный ResponseError:

```json
{
  "uuid": "00000000-0000-0000-0000-000000000000",
  "code": 200,
  "message": "Auth rejected"
}
```

Возвращаемое сообщение можно переопределить в конфиге лаунчер-сервера.
